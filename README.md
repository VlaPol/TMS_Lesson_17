ДЗ по наследованию тебя ждёт после следующей лекции.
В этот раз поработаем со временем.

Будем писать простенький чат. Это один общий чат, куда могут отправлять сообщения множество пользователей.

Иногда возникает задача ограничивать частоту некоторых событий. 
Возможно, ты слышал про DDoS-атаки, когда сервер подвергают угрозе, 
умышленно отправляя на него огромное количество запросов. 
Возможно, ты знаком с таким понятием как флуд в соцсетях и мессенджерах – умышленная отправка большого 
количества однотипных сообщений пользователем.

Программы борются с этими атаками с помощью rate limiting. 
Rate limiting – ограничение количества запросов в единицу времени. 
Например, мы можем ограничить количество возможных запросов на создание сообщений от одного пользователя. 
Если пользователь превышает это ограничение, то мы просто не принимаем его новые сообщения.

Мы реализуем rate limiting в нашем чате. Rate limiting ограничение можно задать по-разному. 
Мы будем задавать некоторый промежуток времени и максимальное количество сообщений, 
которые может отправить один пользователь за указанный промежуток времени. 
Например, максимально 30 сообщений от одного пользователя за 1 минуту времени. 
Когда пользователь пытается отправить новое сообщение, то мы считаем его предыдущие сообщения за последнюю минуту. 
Если их уже 30, то мы отказываем пользователю.

– Сдача ДЗ через Pull Request feature-ветки в main
– Не забудь про gitignore
– Не забудь включить автоформатирование и оптимизацию импортов перед коммитами

– Создай класс, который хранит информацию о пользователе: никнейм (логин) пользователя

– Создай класс, который хранит информацию об одном сообщении в чате: автор сообщения, текстовое содержание сообщения, время отправки

– Создай класс, который описывает бизнес-логику всего чата, хранит историю сообщений. Используй суффикс Service в названии класса
– Прими в конструкторе настройки для rate limiting – временной промежуток и максимальное количество сообщений, которые может отправить один пользователь за указанный промежуток времени (int)
– Объяви метод, который возвращает всю историю чата
– Объяви метод, который позволяет добавить в историю новое сообщение от указанного пользователя с указанным содержимым
– Перед созданием нового сообщения внутри метода нужно проверить, что за указанный в rate limiting промежуток времени пользователь ещё не достиг своего максимума сообщений. Промежуток времени отсчитываем от времени публикации нового сообщения. Если максимум ещё не достигнут, то сообщение успешно добавляется в историю. Если максимум уже достигнут, то новое сообщение не должно быть добавлено. Тут бы хорошо выкинуть исключение, но мы будем возвращать из метода boolean, создалось ли сообщение.

– Создай отдельный класс для демонстрации работы в консоли
– Создай объект сервиса. Предай при вызове конструктора настройки rate limiting: временной промежуток – Duration.ofSeconds(20), максимальное количество сообщений от одного пользователя за временной промежуток – 10. Или можешь поэкспериментировать со своими значениями

Предлагаю такой вариант демонстрации, но можешь выбрать свой:
– В бесконечном цикле запрашивай из консоли строки
– Если строка “история”, то выведи историю сообщений
– Иначе жди строку в формате “логин_пользователя: содержание_сообщения”. Так мы будем имитировать наличие нескольких пользователей. 
Запись означает, что пользователь с указанным логином хочет отправить сообщение с указанным содержанием
– Если сообщение не удалось отправить из-за rate limiting, выведи в консоль “Слишком частые запросы”